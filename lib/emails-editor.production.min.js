"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var EMAIL_REGEXP=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;function validateEmail(e){return EMAIL_REGEXP.test(e)}function styleInject(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===i&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}var css='.emails-editor { background: white; white-space: nowrap; display: flex; flex-wrap: wrap; align-content: flex-start; font-size: 14px; line-height: 24px; padding: 7px 8px 3px; cursor: text; overflow: hidden; }\n.emails-editor__email { position: relative; margin-right: 6px; max-width: 100%; box-sizing: border-box; margin-bottom: 3px; height: 24px; cursor: default; }\n.emails-editor__email-btn-remove { padding-left: 6px; cursor: pointer; font-weight: 300; }\n.emails-editor__email-btn-remove::after { content: "Ã—"; }\n.emails-editor__email--valid { background-color: rgba(102, 152, 255, 0.2); border-radius: 12px; padding-left: 10px; padding-right: 7px; margin-right: 8px; }\n.emails-editor__email--invalid { padding-right: 3px; }\n.emails-editor__email--invalid::after { content: ""; display: block; position: absolute; left: 0; right: 3px; bottom: 0; border-bottom: 1px dashed #d14836; }\n.emails-editor__input { flex-grow: 1; max-width: 100%; font: inherit; height: 24px; border: 0; padding: 0; margin: 0 0 3px; box-shadow: none; outline: none; color: black;  opacity: 1 }\n.emails-editor__input::-ms-clear {  display: none; } \n.emails-editor__input::-webkit-input-placeholder { color: #bbb; opacity: 1; } \n.emails-editor__input::-moz-placeholder { color: #bbb; opacity: 1; } \n.emails-editor__input:-ms-input-placeholder { color: #bbb; opacity: 1; } \n.emails-editor__input::-ms-input-placeholder { color: #bbb; opacity: 1; } \n.emails-editor__input::placeholder { color: #bbb; opacity: 1; }\n.emails-editor__width-calculator { white-space: nowrap; font: inherit; position: absolute; visibility: hidden; top: 0; left: 0; }';styleInject(css);var EmailsEditor=function(e,t){var i=this,a=void 0===t?{}:t,n=a.className,o=void 0===n?"":n,r=a.placeholder,l=void 0===r?"":r,d=a.addMorePlaceholder,s=void 0===d?"":d,c=a.emails,p=void 0===c?[]:c,m=a.onChange;_defineProperty(this,"createEmailBlock",(function(e){var t=["emails-editor__email",validateEmail(e)?"emails-editor__email--valid":"emails-editor__email--invalid"].join(" "),a=document.createElement("span");a.className=t,a.innerText=e;var n=document.createElement("span");return n.className="emails-editor__email-btn-remove",n.addEventListener("click",(function(){var e=i.emailBlocks.indexOf(a);i.removeEmailAtIndex(e)})),a.appendChild(n),a})),_defineProperty(this,"addEmail",(function(e){var t=Array.isArray(e)?e:[e];e&&t.length&&(t.forEach((function(e){if("string"!=typeof e)throw new Error("EmailsEditor: email is expected to be a string, got "+typeof e+": "+e);var t=i.createEmailBlock(e);i.container.insertBefore(t,i.input),i.emails.push(e),i.emailBlocks.push(t)})),i.adjustInputPlaceholder(),i.adjustInputWidth(),i.onChange&&i.onChange(i.getEmails()))})),_defineProperty(this,"addEnteredEmail",(function(){var e=i.input.value.replace(/[\s,]+/g," ").trim().split(" ").filter((function(e){return!!e.trim()}));i.input.value="",i.addEmail(e)})),_defineProperty(this,"removeEmailAtIndex",(function(e){var t=i.container.children[e];i.container.removeChild(t),i.emails.splice(e,1),i.emailBlocks.splice(e,1),i.adjustInputPlaceholder(),i.adjustInputWidth(),i.onChange&&i.onChange(i.getEmails())})),_defineProperty(this,"getEmails",(function(){return i.emails.map((function(e){return{value:e,valid:validateEmail(e)}}))})),_defineProperty(this,"setEmails",(function(e){if(!Array.isArray(e))throw new Error("EmailsEditor: emails are expected to be an array, got "+typeof e);i.emailBlocks.forEach((function(e){i.container.removeChild(e)})),i.emailBlocks=[],i.emails=[],e.length?i.addEmail(e):i.onChange&&i.onChange(i.getEmails())})),_defineProperty(this,"adjustInputPlaceholder",(function(){var e=i.placeholder,t=i.addMorePlaceholder;i.emails.length?i.input.placeholder=t:i.input.placeholder=e})),_defineProperty(this,"adjustInputWidth",(function(){var e=i.input,t=e.placeholder,a=e.value;i.widthCalculator.innerText=a;var n=i.widthCalculator.getBoundingClientRect().width;i.widthCalculator.innerText=t;var o=i.widthCalculator.getBoundingClientRect().width,r=Math.max(n,o);i.input.style.width=r+"px"})),_defineProperty(this,"onKeyDown",(function(e){if("Enter"===e.key)i.addEnteredEmail();else if("Backspace"===e.key){var t=i.input.selectionEnd>0,a=i.emails.length>0;if(t||!a)return;i.removeEmailAtIndex(i.emails.length-1)}})),_defineProperty(this,"onInput",(function(){/[\s,]/.test(i.input.value)?i.addEnteredEmail():i.adjustInputWidth()})),_defineProperty(this,"onBlur",(function(){i.addEnteredEmail()})),_defineProperty(this,"onContainerClick",(function(){i.input.focus()}));var u=document.createElement("input");u.className="emails-editor__input",u.inputMode="email",u.addEventListener("input",this.onInput),u.addEventListener("keydown",this.onKeyDown),u.addEventListener("blur",this.onBlur);var h=document.createElement("div");h.className="emails-editor__width-calculator";var f=document.createElement("div");if(f.className="emails-editor "+o,f.appendChild(u),f.appendChild(h),f.addEventListener("click",this.onContainerClick),this.input=u,this.widthCalculator=h,this.container=f,this.emails=[],this.emailBlocks=[],this.placeholder=l,this.addMorePlaceholder=s,this.addEmail(p),this.adjustInputPlaceholder(),null!=m&&"function"!=typeof m)throw new Error("EmailsEditor: onChange is expected to be a function, got "+typeof m);this.onChange=m,e.appendChild(f)};module.exports=EmailsEditor;
