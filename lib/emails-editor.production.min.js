"use strict";function _defineProperty(e,i,t){return i in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}var EMAIL_REGEXP=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;function validateEmail(e){return EMAIL_REGEXP.test(e)}function styleInject(e,i){void 0===i&&(i={});var t=i.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===t&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}var css='.emails-editor { background: white; white-space: nowrap; display: flex; flex-wrap: wrap; align-content: flex-start; font-size: 14px; line-height: 24px; padding: 7px 8px 3px; cursor: text; overflow: hidden; }\n.emails-editor__email { position: relative; margin-right: 6px; max-width: 100%; box-sizing: border-box; margin-bottom: 3px; height: 24px; cursor: default; }\n.emails-editor__email-btn-remove { padding-left: 6px; cursor: pointer; font-weight: 300; }\n.emails-editor__email-btn-remove::after { content: "Ã—"; }\n.emails-editor__email--valid { background-color: rgba(102, 152, 255, 0.2); border-radius: 12px; padding-left: 10px; padding-right: 7px; margin-right: 8px; }\n.emails-editor__email--invalid { padding-right: 3px; }\n.emails-editor__email--invalid::after { content: ""; display: block; position: absolute; left: 0; right: 3px; bottom: 0; border-bottom: 1px dashed #d14836; }\n.emails-editor__input { flex-grow: 1; max-width: 100%; font: inherit; height: 24px; border: 0; padding: 0; margin: 0 0 3px; box-shadow: none; outline: none; color: black;  opacity: 1 }\n.emails-editor__input::-ms-clear {  display: none; } \n.emails-editor__input::-webkit-input-placeholder { color: #bbb; opacity: 1; } \n.emails-editor__input::-moz-placeholder { color: #bbb; opacity: 1; } \n.emails-editor__input:-ms-input-placeholder { color: #bbb; opacity: 1; } \n.emails-editor__input::-ms-input-placeholder { color: #bbb; opacity: 1; } \n.emails-editor__input::placeholder { color: #bbb; opacity: 1; }\n.emails-editor__width-calculator { white-space: nowrap; font: inherit; position: absolute; visibility: hidden; top: 0; left: 0; }';styleInject(css);var EmailsEditor=function(e,i){var t=this,a=void 0===i?{}:i,n=a.className,l=void 0===n?"":n,o=a.placeholder,r=void 0===o?"":o,d=a.addMorePlaceholder,s=void 0===d?"":d,c=a.emails,p=void 0===c?[]:c,m=a.onChange;_defineProperty(this,"createEmailBlock",(function(e){var i=["emails-editor__email",validateEmail(e)?"emails-editor__email--valid":"emails-editor__email--invalid"].join(" "),a=document.createElement("span");a.className=i,a.innerText=e;var n=document.createElement("span");return n.className="emails-editor__email-btn-remove",n.addEventListener("click",(function(){var e=t.emailBlocks.indexOf(a);t.removeEmailAtIndex(e)})),a.appendChild(n),a})),_defineProperty(this,"addEmail",(function(e){(Array.isArray(e)?e:[e]).forEach((function(e){var i=t.createEmailBlock(e);t.container.insertBefore(i,t.input),t.emails.push(e),t.emailBlocks.push(i)})),t.adjustInputPlaceholder(),t.adjustInputWidth(),t.onChange&&t.onChange(t.getEmails())})),_defineProperty(this,"addEnteredEmail",(function(){var e=t.input.value.replace(/[\s,]+/g," ").trim().split(" ").filter((function(e){return!!e.trim()}));e.length&&(t.input.value="",t.addEmail(e))})),_defineProperty(this,"removeEmailAtIndex",(function(e){var i=t.container.children[e];t.container.removeChild(i),t.emails.splice(e,1),t.emailBlocks.splice(e,1),t.adjustInputPlaceholder(),t.adjustInputWidth(),t.onChange&&t.onChange(t.getEmails())})),_defineProperty(this,"getEmails",(function(){return t.emails.map((function(e){return{value:e,valid:validateEmail(e)}}))})),_defineProperty(this,"setEmails",(function(e){t.emailBlocks.forEach((function(e){t.container.removeChild(e)})),t.emailBlocks=[],t.emails=[],t.addEmail(e)})),_defineProperty(this,"adjustInputPlaceholder",(function(){var e=t.placeholder,i=t.addMorePlaceholder;t.emails.length?t.input.placeholder=i:t.input.placeholder=e})),_defineProperty(this,"adjustInputWidth",(function(){var e=t.input,i=e.placeholder,a=e.value;t.widthCalculator.innerText=a;var n=t.widthCalculator.getBoundingClientRect().width;t.widthCalculator.innerText=i;var l=t.widthCalculator.getBoundingClientRect().width,o=Math.max(n,l);t.input.style.width=o+"px"})),_defineProperty(this,"onKeyDown",(function(e){if("Enter"===e.key)t.addEnteredEmail();else if("Backspace"===e.key){var i=t.input.selectionEnd>0,a=t.emails.length>0;if(i||!a)return;t.removeEmailAtIndex(t.emails.length-1)}})),_defineProperty(this,"onInput",(function(){/[\s,]/.test(t.input.value)?t.addEnteredEmail():t.adjustInputWidth()})),_defineProperty(this,"onBlur",(function(){t.addEnteredEmail()})),_defineProperty(this,"onContainerClick",(function(){t.input.focus()}));var u=document.createElement("input");u.className="emails-editor__input",u.inputMode="email",u.addEventListener("input",this.onInput),u.addEventListener("keydown",this.onKeyDown),u.addEventListener("blur",this.onBlur);var h=document.createElement("div");h.className="emails-editor__width-calculator";var f=document.createElement("div");f.className="emails-editor "+l,f.appendChild(u),f.appendChild(h),f.addEventListener("click",this.onContainerClick),this.input=u,this.widthCalculator=h,this.container=f,this.emails=[],this.emailBlocks=[],this.placeholder=r,this.addMorePlaceholder=s,this.onChange=m,this.addEmail(p),this.adjustInputPlaceholder(),e.appendChild(f)};module.exports=EmailsEditor;
